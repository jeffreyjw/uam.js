
/*
 * -------------------------------------------------------
 * Project: Universal Asset Manager
 * Version: 0.1.0
 *
 * Author:  jeffreyjw
 * Site:     https://github.com/jeffreyjw
 * Contact: jjwojtczak@gmail.com
 *
 *
 * Copyright (c) 2014 jeffreyjw
 * -------------------------------------------------------
 */

"use strict";var UAM;UAM=UAM||{},UAM.Asset=function(){function Asset(url,assetManager){this.assetManager=assetManager,this.url=url}return Asset.prototype.assetManager=null,Asset.prototype.data=null,Asset.prototype.url=null,Asset.prototype.done=function(){return this.assetManager._assetLoaded(this)},Asset.prototype.error=function(){return this.assetManager._raiseError(this)},Asset}();var __indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1};UAM.AssetManager=function(){function AssetManager(config){this.config=config,this.assetTypes=config.assetTypes,this.assetsToLoad=config.assets,this.loadedAssets={}}return AssetManager.prototype.config=null,AssetManager.prototype.assetTypes=null,AssetManager.prototype.assetsToLoad=null,AssetManager.prototype.loadedAssets=null,AssetManager.prototype.onload=null,AssetManager.prototype.onerror=null,AssetManager.prototype.assetsToLoadLength=0,AssetManager.prototype.loadedAssetsLength=0,AssetManager.prototype.load=function(){var key,url,_i,_len,_ref,_results;this.assetsToLoadLength=0;for(key in this.assetsToLoad)for(_ref=this.assetsToLoad[key],_i=0,_len=_ref.length;_len>_i;_i++)url=_ref[_i],++this.assetsToLoadLength;_results=[];for(key in this.assetsToLoad)_results.push(function(){var _j,_len1,_ref1,_results1;for(_ref1=this.assetsToLoad[key],_results1=[],_j=0,_len1=_ref1.length;_len1>_j;_j++)url=_ref1[_j],_results1.push(this.loadAsset(key,url));return _results1}.call(this));return _results},AssetManager.prototype.loadAsset=function(assetType,url){var asset;return __indexOf.call(this.loadedAssets,url)<0?(asset=new UAM.Asset(url,this),this.assetTypes[assetType](url,asset)):void 0},AssetManager.prototype.get=function(url){return this.loadedAssets[url].data},AssetManager.prototype._assetLoaded=function(asset){return this.loadedAssets[asset.url]=asset,++this.loadedAssetsLength,this.loadedAssetsLength===this.assetsToLoadLength&&null!==this.onload?this.onload():void 0},AssetManager.prototype._raiseError=function(){},AssetManager}();